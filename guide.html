<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b0d12" />
  <title>StagePlot Guide</title>

  <style>
    :root{
      --bg:#0b0d12;
      --panel:#121826;
      --panel2:#0f1420;
      --line:#26324a;
      --text:#e9eefb;
      --muted:#a9b4cc;
      --accent:#4aa3ff;
      --ok:#40d98a;
      --warn:#ffcc66;
      --danger:#ff5a6a;
      --grid:rgba(255,255,255,.06);
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background: radial-gradient(1200px 700px at 50% -10%, #1a2540, var(--bg));
      color: var(--text);
      line-height: 1.45;
    }
    header{
      position: sticky;
      top: 0;
      z-index: 10;
      border-bottom: 1px solid var(--line);
      background: rgba(10,12,18,.75);
      backdrop-filter: blur(10px);
    }
    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 14px 16px;
    }
    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .title{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 240px;
    }
    .logo{
      width:28px; height:28px;
      border-radius:10px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      display:flex; align-items:center; justify-content:center;
      color: var(--accent);
      font-weight: 900;
      user-select:none;
    }
    h1{
      font-size: 16px;
      margin: 0;
      letter-spacing: .2px;
    }
    .sub{
      color: var(--muted);
      font-size: 12px;
      margin-top: 2px;
    }
    .actions{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    a.button, button{
      font: inherit;
      color: var(--text);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 12px;
      padding: 8px 10px;
      text-decoration:none;
      cursor:pointer;
      transition: transform .05s ease, border-color .15s ease, background .15s ease;
      display:inline-flex;
      align-items:center;
      gap:8px;
      user-select:none;
    }
    a.button:hover, button:hover{ border-color: rgba(74,163,255,.8); }
    a.button:active, button:active{ transform: translateY(1px); }
    a.button.primary{
      background: rgba(74,163,255,.14);
      border-color: rgba(74,163,255,.55);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      font-size: 12px;
      user-select:none;
      white-space:nowrap;
    }
    .dot{ width:8px; height:8px; border-radius:50%; background: var(--ok); display:inline-block; }

    main{
      max-width: 1100px;
      margin: 0 auto;
      padding: 18px 16px 40px 16px;
      display:grid;
      grid-template-columns: 290px 1fr;
      gap: 14px;
      align-items:start;
    }
    .card{
      background: linear-gradient(180deg, rgba(18,24,38,.9), rgba(12,16,26,.9));
      border: 1px solid var(--line);
      border-radius: 18px;
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      overflow:hidden;
    }
    .card .hd{
      padding: 12px 14px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .card .hd h2{
      margin:0;
      font-size: 13px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: .3px;
      font-weight: 750;
    }
    .card .bd{
      padding: 12px 14px 14px 14px;
    }

    .nav a{
      display:block;
      padding: 9px 10px;
      border-radius: 12px;
      color: var(--text);
      text-decoration:none;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
      margin-bottom: 8px;
      transition: border-color .15s ease, background .15s ease;
    }
    .nav a:hover{
      border-color: rgba(74,163,255,.55);
      background: rgba(74,163,255,.08);
    }
    .nav .hint{
      color: var(--muted);
      font-size: 12px;
      margin-top: 6px;
    }

    h3{
      margin: 0 0 6px 0;
      font-size: 15px;
      letter-spacing:.1px;
    }
    p{ margin: 0 0 10px 0; color: rgba(233,238,251,.92); }
    ul{ margin: 8px 0 14px 20px; padding:0; color: rgba(233,238,251,.92); }
    li{ margin: 6px 0; }

    .callout{
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding: 12px 12px;
      margin: 10px 0 14px 0;
    }
    .callout strong{ color: var(--text); }
    .callout.ok{ border-color: rgba(64,217,138,.25); background: rgba(64,217,138,.08); }
    .callout.warn{ border-color: rgba(255,204,102,.25); background: rgba(255,204,102,.08); }
    .callout.danger{ border-color: rgba(255,90,106,.25); background: rgba(255,90,106,.08); }

    .kbd{
      display:inline-flex;
      align-items:center;
      padding: 2px 8px;
      border-radius: 10px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size: 12px;
      color: rgba(233,238,251,.92);
      white-space:nowrap;
      margin: 0 2px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .mini{
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
      border-radius: 14px;
      padding: 10px;
    }
    .mini .t{
      font-weight: 800;
      font-size: 13px;
      margin-bottom: 4px;
    }
    .mini .d{
      color: var(--muted);
      font-size: 12px;
    }

    .footer{
      margin-top: 8px;
      color: var(--muted);
      font-size: 12px;
    }

    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
    }

    /* Share QR block */
    .shareRow{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-top: 6px;
    }
    .qrWrap{
      display:none;
      margin-top: 12px;
    }
    .qrCard{
      display:flex;
      gap:12px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .qrImg{
      background:#fff;
      padding:10px;
      border-radius:12px;
      width: 240px;
      height: 240px;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .qrImg img{
      width: 220px;
      height: 220px;
      image-rendering: crisp-edges;
      border-radius: 6px;
    }
    .shareMeta{
      flex:1;
      min-width: 240px;
    }
    .tinyLink{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      text-decoration:none;
      color: var(--text);
    }
    .tinyLink:hover{
      border-color: rgba(74,163,255,.55);
      background: rgba(74,163,255,.06);
    }

    @media (max-width: 980px){
      main{ grid-template-columns: 1fr; }
      .nav a{ display:inline-block; margin-right: 8px; }
      .qrImg{ width: 220px; height: 220px; }
      .qrImg img{ width: 200px; height: 200px; }
    }

    @media print{
      header{ display:none !important; }
      body{ background:#fff !important; color:#000 !important; }
      .card{ box-shadow:none !important; background:#fff !important; border:1px solid #ddd !important; }
      .nav{ display:none !important; }
      main{ display:block !important; max-width: 7.8in !important; }
      a{ color:#000 !important; text-decoration:none !important; }
      .callout, .mini{ border:1px solid #ddd !important; background:#fff !important; }

      /* Print-friendly share section */
      .qrWrap{ display:block !important; }
      button{ display:none !important; }
      .qrImg{ border: 1px solid #ddd !important; }
    }
  </style>
</head>

<body>
  <header>
    <div class="wrap">
      <div class="top">
        <div class="title">
          <div class="logo" aria-hidden="true">SP</div>
          <div>
            <h1>StagePlot v2 Guide</h1>
            <div class="sub">How to use StagePlot, all the goodies in one place. Version 1.5.1</div>
          </div>
        </div>

        <div class="actions">
          <span class="pill"><span class="dot"></span>Autosave friendly</span>
          <a class="button primary" href="./index.html">Back to StagePlot</a>
          <button onclick="window.print()">Print this guide</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <aside class="card nav">
      <div class="hd"><h2>Jump to</h2></div>
      <div class="bd">
        <a href="#quickstart">Quick start</a>
        <a href="#share">Share the love</a>
        <a href="#stage">Stage basics</a>
        <a href="#mobile">Mobile layout and accordions</a>
        <a href="#add">Add items</a>
        <a href="#select">Select and multi select</a>
        <a href="#move">Move, nudge, center</a>
        <a href="#resize-rotate">Resize and rotate</a>
        <a href="#edit">Edit details</a>
        <a href="#lists">Inputs and monitor mixes</a>
        <a href="#print">Printing</a>
        <a href="#pdf">Exporting a PDF</a>
        <a href="#export">Export and import</a>
        <a href="#shortcuts">Keyboard shortcuts</a>
        <a href="#tips">Pro tips</a>
        <a href="#trouble">Troubleshooting</a>
        <div class="hint">Tip: On mobile, scroll is life. On desktop, click these to teleport.</div>
      </div>
    </aside>

    <section class="card">
      <div class="hd">
        <h2>Welcome</h2>
        <span class="pill">Guide for v1.5.1</span>
      </div>
      <div class="bd">
        <p>
          StagePlot is a drag and drop stage plot builder. You can place players and gear on a stage, add inputs and monitor mixes, and print a clean one page handoff.
          It is meant to be fast, readable, and not a spreadsheet punishment.
        </p>

        <div class="callout ok">
          <strong>Autosave:</strong> Everything saves automatically in your browser. No login. No cloud. If you close the tab and come back, it should still be there.
        </div>

        <div class="grid">
          <div class="mini">
            <div class="t">What you build</div>
            <div class="d">A stage plot plus a one page info sheet: inputs, mixes, and notes.</div>
          </div>
          <div class="mini">
            <div class="t">What you can share</div>
            <div class="d">Export a project JSON to send to the band or the venue, then import it later.</div>
          </div>
        </div>

        <hr style="border:0;border-top:1px solid rgba(255,255,255,.08); margin:14px 0;" />

        <h3 id="quickstart">Quick start</h3>
        <ul>
          <li>Pick your stage size in the Item library panel. Small, medium, large, or custom.</li>
          <li>Search the library and hit Add to drop gear on the stage.</li>
          <li>Click an item to edit it in the One-page print info panel. Label, input, mix, notes, color, scale, rotation.</li>
          <li>Build your full plot, then hit Print for the clean one page view.</li>
        </ul>

        <div class="callout warn">
          <strong>If your print preview ever looks blank:</strong> hit the app Print button again. StagePlot forces a quick print-safe layout + rerender before the print dialog opens.
          If it still blanks, see troubleshooting below.
        </div>

        <h3 id="share">Share the love</h3>
        <div class="callout ok">
          <strong>Please share the love.</strong>
          <p style="margin-top:8px;">
            If StagePlot saves you time (or saves your band from the “wait, where do you want the keys?” conversation), pass it along.
            Share the link with a bandmate, a venue, a sound human, or that one friend who always shows up with a DI and good vibes.
          </p>

          <div class="shareRow">
            <a class="tinyLink" href="https://petesimple.github.io/stageplot/" target="_blank" rel="noopener">
              Open StagePlot link
            </a>
            <button type="button" class="button" onclick="toggleQR()">Show QR code</button>
            <button type="button" class="button" onclick="copyAppLink()">Copy link</button>
          </div>

          <div class="qrWrap" id="qrWrap">
            <div class="qrCard">
              <div class="qrImg">
                <img
                  id="qrImg"
                  src="https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=https%3A%2F%2Fpetesimple.github.io%2Fstageplot%2F"
                  alt="QR code linking to StagePlot"
                />
              </div>
              <div class="shareMeta">
                <p>
                  <strong>Scan to open StagePlot:</strong> aim your phone camera at the QR code and tap the link.
                  This is perfect for tablets, rehearsal rooms, and sending it to someone standing right next to you.
                </p>
                <div class="callout" style="margin:10px 0 0 0;">
                  <strong>Link:</strong>
                  <div class="mono" id="appLinkText">https://petesimple.github.io/stageplot/</div>
                </div>
                <div class="footer">
                  Tip: Printing this guide includes the QR code automatically, so the paper itself becomes a “scan to open” flyer.
                </div>
              </div>
            </div>
          </div>
        </div>

        <h3 id="stage">Stage basics</h3>
        <p>
          The stage is measured in feet using Width x Depth. Upstage is at the top of the plot and audience is downstage at the bottom.
          Items are positioned relative to the stage scale, so if you change the stage size later, your layout should stay sensible.
        </p>
        <ul>
          <li><strong>Stage preset:</strong> swaps the stage W and D quickly.</li>
          <li><strong>Custom stage:</strong> type W and D yourself.</li>
          <li><strong>Click empty stage space:</strong> clears selection.</li>
        </ul>

        <h3 id="mobile">Mobile layout and accordions</h3>
        <p>
          On mobile (or narrow screens), StagePlot switches to a stacked layout so you can work top to bottom.
          The library and info panels become accordions, and StagePlot remembers what you left open.
        </p>
        <ul>
          <li><strong>Stage goes first:</strong> the stage panel is at the top for quick drag and place.</li>
          <li><strong>Accordion panels:</strong> Item library and One-page print info can collapse to save scroll.</li>
          <li><strong>Auto open info on selection:</strong> when you add/select an item, the info panel opens automatically so edits are right there.</li>
          <li><strong>Desktop stays normal:</strong> wide screens keep the classic three panel layout, both panels open.</li>
        </ul>

        <div class="callout ok">
          <strong>Mobile tip:</strong> Add an item, tweak it on the info panel, repeat. The app tries to keep the next step in your face.
        </div>

        <h3 id="add">Add items</h3>
        <p>Use the Item library panel to add stuff.</p>
        <ul>
          <li><strong>Search:</strong> type guitar, outlet, riser, mic, etc.</li>
          <li><strong>Category:</strong> filter by People, Instruments, Stage gear, Electrical, and so on.</li>
          <li><strong>Add:</strong> drops the item onto the stage near the center.</li>
          <li><strong>Misc buttons:</strong> quick drop generic blocks for mystery gear, pedals, weird props, or the thing nobody can name.</li>
        </ul>

        <div class="callout">
          <strong>Safari note:</strong> If icons ever show on the stage but not in the Item library, it is usually Safari being picky about SVG sizing.
          The fix is to explicitly size <span class="kbd">.catIcon svg.icon</span> (the app includes that fix).
        </div>

        <h3 id="select">Select and multi select</h3>
        <p>
          Single selection is the default. Multi select lets you move a bunch of stuff together, like a full drum world or a horn section pile.
        </p>

        <div class="callout ok">
          <strong>Multi select methods:</strong>
          <ul>
            <li><strong>Shift + Click</strong> toggles an item into or out of the selection.</li>
            <li><strong>Cmd + Click</strong> (Mac) or <strong>Ctrl + Click</strong> (Windows) does the same.</li>
            <li><strong>Drag select:</strong> drag on empty stage space to draw a selection box.</li>
            <li><strong>Click empty stage space:</strong> clears selection (unless you are using a modifier key).</li>
          </ul>
          <div class="footer">
            Note: If you grab a resize handle or the rotate dot, it will do that action instead of selection.
          </div>
        </div>

        <p>
          When multiple items are selected, move and nudge apply to the group. Item detail editing focuses on the primary selected item.
        </p>

        <h3 id="move">Move, nudge, center</h3>
        <ul>
          <li><strong>Drag:</strong> click and drag an item to move it.</li>
          <li><strong>Drag a selected group:</strong> if you have multi select active, drag any selected item and the group moves together.</li>
          <li><strong>Nudge:</strong> <span class="kbd">Shift</span> + <span class="kbd">Arrow</span> moves the selection by 0.25 ft.</li>
          <li><strong>Center selection:</strong> centers the selected group into a sensible stage position.</li>
          <li><strong>Duplicate:</strong> duplicates the selected item(s). Also supports hotkey below.</li>
        </ul>

        <h3 id="resize-rotate">Resize and rotate</h3>
        <p>
          When an item is selected, you get dots for resizing and a blue dot for rotation.
        </p>
        <ul>
          <li><strong>Resize:</strong> drag the corner or edge dots.</li>
          <li><strong>Rotate:</strong> drag the blue dot above the item.</li>
          <li><strong>Rotate snap:</strong> hold <span class="kbd">Shift</span> while rotating to snap 15 degrees.</li>
          <li><strong>Reset rotation:</strong> click Reset rotation in the info panel.</li>
          <li><strong>Scale slider:</strong> adjusts the overall footprint without changing the base shape.</li>
        </ul>

        <h3 id="edit">Edit details</h3>
        <p>The One-page print info panel is where the real world info lives.</p>
        <ul>
          <li><strong>Band name:</strong> optional. It prints at the top of the print page.</li>
          <li><strong>Label:</strong> what shows on the item. Example: Pete Vox, Dave Guitar, Tim Keys.</li>
          <li><strong>Input:</strong> channel, DI, multi, or whatever your world uses. Example: Ch 1, Ch 12, Multi.</li>
          <li><strong>Mix:</strong> monitor mix label. Example: M1, M2, IEM, Wedge 3.</li>
          <li><strong>Notes:</strong> item level notes like needs boom, DI after pedals, phantom power, hates bright lights.</li>
          <li><strong>Color:</strong> quick visual grouping. Example: all vocals one color, all power another.</li>
        </ul>

        <h3 id="lists">Inputs and monitor mixes</h3>
        <p>
          StagePlot automatically builds two readable tables from your items:
        </p>
        <ul>
          <li><strong>Inputs table:</strong> lists channel and source, sorted by channel text.</li>
          <li><strong>Monitor mixes table:</strong> groups by mix and lists who is on it, plus notes.</li>
        </ul>

        <div class="callout">
          <strong>Show notes:</strong> use this for parking, load in notes, contact, backline details, set length, and anything that saves everyone time.
          The preview box shows exactly what prints.
        </div>

        <h3 id="print">Printing</h3>
        <p>
          Hit Print to get the one page view. StagePlot temporarily switches into a print-safe layout (fixed stage size, panels open, library hidden),
          then restores your normal layout after printing.
        </p>
        <ul>
          <li><strong>Best results:</strong> print in Portrait, default margins, and let the app handle layout.</li>
          <li><strong>What prints:</strong> band name header, stage plot, inputs list, monitor mixes, show notes.</li>
          <li><strong>Tip:</strong> use the app Print button (not the browser menu) so the print layout hook runs.</li>
        </ul>

        <h3 id="pdf">Exporting a PDF</h3>
        <p>
          StagePlot uses your device’s built in print system to create PDFs. This is the most reliable way to get a clean one page result across
          Windows, Mac, iOS, and Android.
        </p>

        <div class="callout ok">
          <strong>Best practice:</strong> Use the StagePlot <span class="kbd">Print</span> button first, then choose your system’s “Save as PDF” option.
          The app Print button prepares a print-safe layout before the dialog opens.
        </div>

        <h4 style="margin:0 0 6px 0;">Windows (PC)</h4>
        <ul>
          <li>Click <strong>Print</strong> in StagePlot</li>
          <li>Printer dropdown: choose <strong>Microsoft Print to PDF</strong></li>
          <li>Click <strong>Print</strong></li>
          <li>Pick a filename and save location</li>
        </ul>

        <h4 style="margin:0 0 6px 0;">macOS (Mac)</h4>
        <ul>
          <li>Click <strong>Print</strong> in StagePlot</li>
          <li>Bottom left: click <strong>PDF</strong></li>
          <li>Choose <strong>Save as PDF</strong></li>
          <li>Name it and save</li>
        </ul>

        <h4 style="margin:0 0 6px 0;">iPhone and iPad (iOS)</h4>
        <ul>
          <li>Tap <strong>Print</strong> in StagePlot</li>
          <li>When the preview appears, pinch out (zoom in) on the preview with two fingers</li>
          <li>You will see a full screen PDF preview</li>
          <li>Tap Share, then Save to Files or send it</li>
        </ul>

        <h4 style="margin:0 0 6px 0;">Android</h4>
        <ul>
          <li>Tap <strong>Print</strong> in StagePlot</li>
          <li>Select <strong>Save as PDF</strong> as the printer</li>
          <li>Tap Save and choose where to store it</li>
        </ul>

        <div class="callout">
          <strong>Why this method:</strong>
          Using the system print-to-PDF keeps text sharp, preserves the one page layout, and avoids browser-specific PDF bugs.
          A “one click Export PDF” button is possible later, but this is the cleanest universal method today.
        </div>

        <h3 id="export">Export and import</h3>
        <p>
          Two things can be exported and imported:
        </p>
        <ul>
          <li><strong>Project:</strong> your stage size, items, band name, and notes.</li>
          <li><strong>Library:</strong> your custom item types (import/export your personalized gear zoo).</li>
        </ul>

        <div class="callout ok">
          <strong>Safe move:</strong> Export your project before a big edit spree. It is the save point you can actually email to yourself.
        </div>

        <h3 id="shortcuts">Keyboard shortcuts</h3>
        <ul>
          <li><span class="kbd">Cmd</span> or <span class="kbd">Ctrl</span> + <span class="kbd">D</span> - Duplicate selected</li>
          <li><span class="kbd">Shift</span> + <span class="kbd">Arrow</span> - Nudge 0.25 ft</li>
          <li><span class="kbd">Shift</span> + click - Multi select toggle</li>
          <li><span class="kbd">Cmd</span> or <span class="kbd">Ctrl</span> + click - Multi select toggle</li>
        </ul>

        <h3 id="tips">Pro tips</h3>
        <ul>
          <li>Color code by role: vocals, instruments, power, wedges, IEMs.</li>
          <li>Use the Mix field consistently. M1, M2, M3 works great for quick reading.</li>
          <li>For drums, use one Drums block plus notes, or add extra Misc blocks for kick, rack, floor, SPD, etc.</li>
          <li>Use Show notes for the stuff that prevents ten questions at load in.</li>
          <li>Export the project and text it to the band and venue. Your future self will thank you.</li>
        </ul>

        <h3 id="trouble">Troubleshooting</h3>

        <div class="callout danger">
          <strong>Print preview is blank</strong>
          <ul>
            <li>Click the app Print button again. The app forces a print-safe rerender before opening print preview.</li>
            <li>Wait a second after opening print preview. Some browsers lag before painting.</li>
            <li>Try a different browser (Chrome, Edge, Safari). Print engines can be spicy.</li>
            <li>If you are using a PWA installed app, try printing from the normal browser tab once.</li>
          </ul>
        </div>

        <div class="callout warn">
          <strong>Stage looks cut off at the bottom on desktop</strong>
          <ul>
            <li>Make the browser window taller or go full screen.</li>
            <li>Zoom out slightly in the browser.</li>
            <li>On smaller screens, the app switches to stacked layout. That can change stage height. It is normal.</li>
          </ul>
        </div>

        <div class="callout">
          <strong>My stuff disappeared</strong>
          <ul>
            <li>StagePlot saves in localStorage. If you cleared browser site data, it will reset.</li>
            <li>Use Export project as your backup habit.</li>
            <li>If you use multiple browsers or devices, each has its own local save.</li>
          </ul>
        </div>

        <div class="footer">
          Built for speed and sanity. If something feels annoying, that is a bug with a personality and we can fix it.
        </div>
      </div>
    </section>
  </main>

  <script>
    // Smooth anchor scrolling, tiny quality of life
    document.querySelectorAll('a[href^="#"]').forEach(a => {
      a.addEventListener("click", (e) => {
        const id = a.getAttribute("href");
        const el = document.querySelector(id);
        if(!el) return;
        e.preventDefault();
        el.scrollIntoView({ behavior: "smooth", block: "start" });
        history.replaceState(null, "", id);
      });
    });

    const APP_LINK = "https://petesimple.github.io/stageplot/";

    function toggleQR(){
      const el = document.getElementById("qrWrap");
      const show = (el.style.display === "none" || !el.style.display);
      el.style.display = show ? "block" : "none";
      if(show){
        // small nicety: ensure QR + link reflect the constant
        document.getElementById("appLinkText").textContent = APP_LINK;
        const q = document.getElementById("qrImg");
        const enc = encodeURIComponent(APP_LINK);
        q.src = `https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${enc}`;
      }
    }

    async function copyAppLink(){
      try{
        await navigator.clipboard.writeText(APP_LINK);
        alert("Copied StagePlot link to clipboard.");
      }catch(e){
        // fallback
        const t = document.getElementById("appLinkText");
        if(t){
          const r = document.createRange();
          r.selectNodeContents(t);
          const sel = window.getSelection();
          sel.removeAllRanges();
          sel.addRange(r);
        }
        alert("Could not auto-copy on this browser. The link is highlighted - copy it.");
      }
    }
  </script>
</body>
</html>