<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b0d12" />
  <title>StagePlot Guide</title>

  <style>
    :root{
      --bg:#0b0d12;
      --panel:#121826;
      --panel2:#0f1420;
      --line:#26324a;
      --text:#e9eefb;
      --muted:#a9b4cc;
      --accent:#4aa3ff;
      --ok:#40d98a;
      --warn:#ffcc66;
      --danger:#ff5a6a;
      --grid:rgba(255,255,255,.06);
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background: radial-gradient(1200px 700px at 50% -10%, #1a2540, var(--bg));
      color: var(--text);
      line-height: 1.45;
    }
    header{
      position: sticky;
      top: 0;
      z-index: 10;
      border-bottom: 1px solid var(--line);
      background: rgba(10,12,18,.75);
      backdrop-filter: blur(10px);
    }
    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 14px 16px;
    }
    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .title{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 240px;
    }
    .logo{
      width:28px; height:28px;
      border-radius:10px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      display:flex; align-items:center; justify-content:center;
      color: var(--accent);
      font-weight: 900;
      user-select:none;
    }
    h1{
      font-size: 16px;
      margin: 0;
      letter-spacing: .2px;
    }
    .sub{
      color: var(--muted);
      font-size: 12px;
      margin-top: 2px;
    }
    .actions{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    a.button, button{
      font: inherit;
      color: var(--text);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 12px;
      padding: 8px 10px;
      text-decoration:none;
      cursor:pointer;
      transition: transform .05s ease, border-color .15s ease, background .15s ease;
      display:inline-flex;
      align-items:center;
      gap:8px;
      user-select:none;
    }
    a.button:hover, button:hover{ border-color: rgba(74,163,255,.8); }
    a.button:active, button:active{ transform: translateY(1px); }
    a.button.primary{
      background: rgba(74,163,255,.14);
      border-color: rgba(74,163,255,.55);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      font-size: 12px;
      user-select:none;
      white-space:nowrap;
    }
    .dot{ width:8px; height:8px; border-radius:50%; background: var(--ok); display:inline-block; }

    main{
      max-width: 1100px;
      margin: 0 auto;
      padding: 18px 16px 40px 16px;
      display:grid;
      grid-template-columns: 290px 1fr;
      gap: 14px;
      align-items:start;
    }
    .card{
      background: linear-gradient(180deg, rgba(18,24,38,.9), rgba(12,16,26,.9));
      border: 1px solid var(--line);
      border-radius: 18px;
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      overflow:hidden;
    }
    .card .hd{
      padding: 12px 14px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .card .hd h2{
      margin:0;
      font-size: 13px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: .3px;
      font-weight: 750;
    }
    .card .bd{
      padding: 12px 14px 14px 14px;
    }

    .nav a{
      display:block;
      padding: 9px 10px;
      border-radius: 12px;
      color: var(--text);
      text-decoration:none;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
      margin-bottom: 8px;
      transition: border-color .15s ease, background .15s ease;
    }
    .nav a:hover{
      border-color: rgba(74,163,255,.55);
      background: rgba(74,163,255,.08);
    }
    .nav .hint{
      color: var(--muted);
      font-size: 12px;
      margin-top: 6px;
    }

    h3{
      margin: 0 0 6px 0;
      font-size: 15px;
      letter-spacing:.1px;
    }
    h4{
      margin: 10px 0 6px 0;
      font-size: 14px;
      letter-spacing:.1px;
      color: rgba(233,238,251,.95);
    }
    p{ margin: 0 0 10px 0; color: rgba(233,238,251,.92); }
    ul{ margin: 8px 0 14px 20px; padding:0; color: rgba(233,238,251,.92); }
    li{ margin: 6px 0; }

    .callout{
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding: 12px 12px;
      margin: 10px 0 14px 0;
    }
    .callout strong{ color: var(--text); }
    .callout.ok{ border-color: rgba(64,217,138,.25); background: rgba(64,217,138,.08); }
    .callout.warn{ border-color: rgba(255,204,102,.25); background: rgba(255,204,102,.08); }
    .callout.danger{ border-color: rgba(255,90,106,.25); background: rgba(255,90,106,.08); }

    .kbd{
      display:inline-flex;
      align-items:center;
      padding: 2px 8px;
      border-radius: 10px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size: 12px;
      color: rgba(233,238,251,.92);
      white-space:nowrap;
      margin: 0 2px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .mini{
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
      border-radius: 14px;
      padding: 10px;
    }
    .mini .t{
      font-weight: 800;
      font-size: 13px;
      margin-bottom: 4px;
    }
    .mini .d{
      color: var(--muted);
      font-size: 12px;
    }

    .footer{
      margin-top: 8px;
      color: var(--muted);
      font-size: 12px;
    }

    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
    }

    /* Share QR block */
    .shareRow{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-top: 6px;
    }
    .qrWrap{
      display:none;
      margin-top: 12px;
    }
    .qrCard{
      display:flex;
      gap:12px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .qrImg{
      background:#fff;
      padding:10px;
      border-radius:12px;
      width: 240px;
      height: 240px;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .qrImg img{
      width: 220px;
      height: 220px;
      image-rendering: crisp-edges;
      border-radius: 6px;
    }
    .shareMeta{
      flex:1;
      min-width: 240px;
    }
    .tinyLink{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      text-decoration:none;
      color: var(--text);
    }
    .tinyLink:hover{
      border-color: rgba(74,163,255,.55);
      background: rgba(74,163,255,.06);
    }

    @media (max-width: 980px){
      main{ grid-template-columns: 1fr; }
      .nav a{ display:inline-block; margin-right: 8px; }
      .qrImg{ width: 220px; height: 220px; }
      .qrImg img{ width: 200px; height: 200px; }
    }

    @media print{
      header{ display:none !important; }
      body{ background:#fff !important; color:#000 !important; }
      .card{ box-shadow:none !important; background:#fff !important; border:1px solid #ddd !important; }
      .nav{ display:none !important; }
      main{ display:block !important; max-width: 7.8in !important; }
      a{ color:#000 !important; text-decoration:none !important; }
      .callout, .mini{ border:1px solid #ddd !important; background:#fff !important; }

      /* Print-friendly share section */
      .qrWrap{ display:block !important; }
      button{ display:none !important; }
      .qrImg{ border: 1px solid #ddd !important; }
    }
  </style>
</head>

<body>
  <header>
    <div class="wrap">
      <div class="top">
        <div class="title">
          <div class="logo" aria-hidden="true">SP</div>
          <div>
            <h1>StagePlot Guide</h1>
            <div class="sub">How to use StagePlot - updated for version 1.5.5 (metric)</div>
          </div>
        </div>

        <div class="actions">
          <span class="pill"><span class="dot"></span>Autosave friendly</span>
          <a class="button primary" href="./index.html">Back to StagePlot</a>
          <button onclick="window.print()">Print this guide</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <aside class="card nav">
      <div class="hd"><h2>Jump to</h2></div>
      <div class="bd">
        <a href="#quickstart">Quick start</a>
        <a href="#new">What’s new in 1.5.5</a>
        <a href="#share">Share the love</a>
        <a href="#layout">Layout (desktop vs mobile)</a>
        <a href="#stageview">Stage and View</a>
        <a href="#units">Units (Feet vs Meters)</a>
        <a href="#add">Add items</a>
        <a href="#select">Select and multi select</a>
        <a href="#move">Move, nudge, center</a>
        <a href="#resize-rotate">Resize and rotate</a>
        <a href="#edit">Edit details</a>
        <a href="#lists">Inputs and monitor mixes</a>
        <a href="#print">Printing</a>
        <a href="#pdf">Exporting a PDF</a>
        <a href="#export">Export and import</a>
        <a href="#shortcuts">Keyboard shortcuts</a>
        <a href="#tips">Pro tips</a>
        <a href="#trouble">Troubleshooting</a>
        <div class="hint">Tip: On mobile, scroll is life. On desktop, click these to teleport.</div>
      </div>
    </aside>

    <section class="card">
      <div class="hd">
        <h2>Welcome</h2>
        <span class="pill">Guide for v1.5.5</span>
      </div>

      <div class="bd">
        <p>
          StagePlot is a drag and drop stage plot builder. You can place players and gear on a stage, add inputs and monitor mixes,
          and print a clean one page handoff. It is meant to be fast, readable, and not a spreadsheet punishment.
        </p>

        <div class="callout ok">
          <strong>Autosave:</strong> Everything saves automatically in your browser. No login. No cloud. If you close the tab and come back,
          it should still be there.
        </div>

        <div class="grid">
          <div class="mini">
            <div class="t">What you build</div>
            <div class="d">A stage plot plus a one page info sheet: inputs, mixes, and notes.</div>
          </div>
          <div class="mini">
            <div class="t">What you can share</div>
            <div class="d">Export a project JSON to send to the band or venue, then import it later.</div>
          </div>
        </div>

        <hr style="border:0;border-top:1px solid rgba(255,255,255,.08); margin:14px 0;" />

        <h3 id="quickstart">Quick start</h3>
        <ul>
          <li>Pick your stage size in the Stage panel (preset or custom).</li>
          <li>Add items from the Library (or drop Misc blocks for mystery gear).</li>
          <li>Click an item to edit it in the One-page info panel (label, input, mix, notes, color, scale, rotation).</li>
          <li>Use View Zoom for tight placement, then Reset View to 100% when you want the clean “fits in the square” view.</li>
          <li>When it looks right, hit Print for the clean one page view.</li>
        </ul>

        <h3 id="new">What’s new in 1.5.5 (metric)</h3>
        <div class="callout ok">
          <ul>
            <li><strong>Metric units option:</strong> toggle the stage measurements between <strong>Feet</strong> and <strong>Meters</strong>.</li>
            <li><strong>Stage presets updated:</strong> stage sizes can display in meters, with clean readable values.</li>
            <li><strong>No layout chaos:</strong> switching units is display-friendly and keeps your plot sensible.</li>
            <li><strong>View tools still rock:</strong> stage stays inside the square at 100%, plus View Zoom + Reset View.</li>
          </ul>
          <div class="footer">
            Translation: you can talk to venues in meters without rethinking your entire life.
          </div>
        </div>

        <h3 id="share">Share the love</h3>
        <div class="callout ok">
          <strong>Please share the love.</strong>
          <p style="margin-top:8px;">
            If StagePlot saves you time (or saves your band from the “wait, where do you want the keys?” conversation), pass it along.
          </p>

          <div class="shareRow">
            <a class="tinyLink" href="https://petesimple.github.io/stageplot/" target="_blank" rel="noopener">
              Open StagePlot link
            </a>
            <button type="button" class="button" onclick="toggleQR()">Show QR code</button>
            <button type="button" class="button" onclick="copyAppLink()">Copy link</button>
          </div>

          <div class="qrWrap" id="qrWrap">
            <div class="qrCard">
              <div class="qrImg">
                <img
                  id="qrImg"
                  src="https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=https%3A%2F%2Fpetesimple.github.io%2Fstageplot%2F"
                  alt="QR code linking to StagePlot"
                />
              </div>
              <div class="shareMeta">
                <p>
                  <strong>Scan to open StagePlot:</strong> aim your phone camera at the QR code and tap the link.
                </p>
                <div class="callout" style="margin:10px 0 0 0;">
                  <strong>Link:</strong>
                  <div class="mono" id="appLinkText">https://petesimple.github.io/stageplot/</div>
                </div>
                <div class="footer">
                  Tip: Printing this guide includes the QR code automatically, so the paper becomes a “scan to open” flyer.
                </div>
              </div>
            </div>
          </div>

          <div class="callout warn" style="margin:12px 0 0 0;">
            <strong>Keep this little project afloat</strong>
            <p style="margin-top:8px;">
              If StagePlot saved you even 10 minutes of load-in chaos, consider tossing a few bucks in the tip jar.
              It helps cover the “miscellaneous tech gremlins” budget and keeps updates coming.
            </p>
            <div class="shareRow">
              <a class="tinyLink" href="https://www.paypal.com/ncp/payment/LTXDLQ6W4JZV8" target="_blank" rel="noopener">
                Donate via PayPal (no pressure)
              </a>
              <span class="pill">If not, share it and roast me gently</span>
            </div>
          </div>
        </div>

        <!-- Layout first (requested), then tools below -->
        <h3 id="layout">Layout (desktop vs mobile)</h3>
        <p>
          StagePlot keeps the stage at the top of the experience, especially on mobile.
          The goal is simple: you should always see the plot first, then the controls underneath.
        </p>

        <div class="callout ok">
          <strong>Desktop (wide screens):</strong>
          <ul>
            <li>Classic multi-panel layout.</li>
            <li>Stage stays prominent, with your library and info panel nearby.</li>
            <li>Great for fast building with mouse/trackpad.</li>
          </ul>
          <strong>Mobile (narrow screens):</strong>
          <ul>
            <li>Stacked layout: stage and plot preview first.</li>
            <li>Tools appear below the stage so you are not hunting for them.</li>
            <li>Library and One-page info use accordions to save scroll space.</li>
          </ul>
          <div class="footer">
            Tip: Add item, tap it, edit it, repeat. The app tries to put the next step right in your face.
          </div>
        </div>

        <h3 id="stageview">Stage and View</h3>
        <p>
          This section covers stage sizing, keeping the plot inside the square, and the view tools that help with fine placement.
          In the app, the stage layout stays at the top, and these tools live underneath (especially on mobile).
        </p>

        <h4>Stage basics</h4>
        <ul>
          <li><strong>Upstage is at the top</strong>, audience is downstage at the bottom (standard stage plot convention).</li>
          <li><strong>Stage size:</strong> set Width x Depth using presets or custom values.</li>
          <li><strong>Click empty stage space:</strong> clears selection.</li>
        </ul>

        <h4>View tools (under the layout)</h4>
        <div class="callout ok">
          <ul>
            <li><strong>Stage stays inside the square at 100%:</strong> when View Zoom is 100%, you get the clean “fits in the square” view.</li>
            <li><strong>View Zoom:</strong> zooms the view in/out inside the stage square for detail work (without changing item sizes).</li>
            <li><strong>Reset View:</strong> snaps View Zoom back to <strong>100%</strong> instantly.</li>
          </ul>
          <div class="footer">
            Remember: <strong>Scale</strong> changes an item’s footprint. <strong>View Zoom</strong> changes how close you are while editing.
          </div>
        </div>

        <h3 id="units">Units (Feet vs Meters)</h3>
        <p>
          Version 1.5.5 adds a units toggle so you can talk in the measurement system your venue actually uses.
        </p>

        <div class="callout ok">
          <strong>How to use it</strong>
          <ul>
            <li><strong>Units toggle:</strong> switch between <strong>Feet</strong> and <strong>Meters</strong> in the stage controls.</li>
            <li><strong>Presets:</strong> stage preset values display in the current unit.</li>
            <li><strong>Custom values:</strong> type the size in the unit you selected.</li>
          </ul>
          <div class="footer">
            Pro vibe: if a venue says “our stage is 6m wide,” you can match that without doing parking-lot math.
          </div>
        </div>

        <div class="callout warn">
          <strong>Printing tip:</strong> If you care about a consistent one-page print look, keep View Zoom at 100% (use Reset View).
          Use View Zoom for editing, then reset before printing.
        </div>

        <h3 id="add">Add items</h3>
        <p>Use the Item library panel to add stuff.</p>
        <ul>
          <li><strong>Search:</strong> type guitar, outlet, riser, mic, etc.</li>
          <li><strong>Category:</strong> filter by People, Instruments, Stage gear, Electrical, and so on.</li>
          <li><strong>Add:</strong> drops the item onto the stage near center.</li>
          <li><strong>Misc blocks:</strong> quick drop generic blocks for mystery gear, pedals, props, or the thing nobody can name.</li>
        </ul>

        <h3 id="select">Select and multi select</h3>
        <p>Single selection is default. Multi select lets you move a bunch of stuff together.</p>
        <div class="callout ok">
          <strong>Multi select methods:</strong>
          <ul>
            <li><strong>Shift + Click</strong> toggles an item into/out of selection.</li>
            <li><strong>Cmd + Click</strong> (Mac) or <strong>Ctrl + Click</strong> (Windows) does the same.</li>
            <li><strong>Drag select:</strong> drag on empty stage space to draw a selection box.</li>
            <li><strong>Click empty stage space:</strong> clears selection (unless using a modifier).</li>
          </ul>
        </div>

        <h3 id="move">Move, nudge, center</h3>
        <ul>
          <li><strong>Drag:</strong> click and drag an item to move it.</li>
          <li><strong>Group drag:</strong> multi select + drag any selected item to move the group.</li>
          <li><strong>Nudge:</strong> <span class="kbd">Shift</span> + <span class="kbd">Arrow</span> moves selection by 0.25 ft (or equivalent spacing conceptually).</li>
          <li><strong>Center selection:</strong> centers selected group into a sensible position.</li>
          <li><strong>Duplicate:</strong> duplicates selected item(s). Also supports hotkey below.</li>
        </ul>

        <h3 id="resize-rotate">Resize and rotate</h3>
        <p>Selected items show resize handles and a blue rotate dot.</p>
        <ul>
          <li><strong>Resize:</strong> drag corner/edge dots.</li>
          <li><strong>Rotate:</strong> drag the blue dot above the item.</li>
          <li><strong>Rotate snap:</strong> hold <span class="kbd">Shift</span> while rotating to snap 15 degrees.</li>
          <li><strong>Reset rotation:</strong> use Reset rotation in the info panel.</li>
        </ul>

        <h3 id="edit">Edit details</h3>
        <p>The One-page info panel is where the real world info lives.</p>
        <ul>
          <li><strong>Band name:</strong> prints at the top of the one-page output.</li>
          <li><strong>Label:</strong> what shows on the item (Pete Vox, Dave Guitar, etc.).</li>
          <li><strong>Input:</strong> channel/DI/multi/etc.</li>
          <li><strong>Mix:</strong> monitor mix label (M1, M2, IEM, etc.).</li>
          <li><strong>Notes:</strong> boom stand, DI after pedals, phantom power, etc.</li>
          <li><strong>Color:</strong> quick visual grouping (vocals, power, wedges, etc.).</li>
        </ul>

        <h3 id="lists">Inputs and monitor mixes</h3>
        <p>StagePlot automatically builds two readable tables from your items:</p>
        <ul>
          <li><strong>Inputs table:</strong> lists channel + source, sorted by channel text.</li>
          <li><strong>Monitor mix table:</strong> groups by mix and lists who is on it + notes.</li>
        </ul>

        <h3 id="print">Printing</h3>
        <p>
          Hit Print to get the one page view. StagePlot temporarily switches into a print-safe layout, then restores your normal layout after printing.
        </p>
        <ul>
          <li><strong>Best results:</strong> Portrait, default margins.</li>
          <li><strong>Tip:</strong> use the app Print button (not the browser menu) so the print layout hook runs.</li>
        </ul>

        <h3 id="pdf">Exporting a PDF</h3>
        <p>
          StagePlot uses your device’s built in print system to create PDFs. This keeps text sharp and preserves the one page layout.
        </p>
        <div class="callout ok">
          <strong>Best practice:</strong> Click StagePlot <span class="kbd">Print</span> then choose “Save as PDF” in your system print dialog.
        </div>

        <h3 id="export">Export and import</h3>
        <p>Two things can be exported and imported:</p>
        <ul>
          <li><strong>Project:</strong> stage size, items, band name, and show notes.</li>
          <li><strong>Library:</strong> your custom item types (export/import your personalized gear zoo).</li>
        </ul>

        <h3 id="shortcuts">Keyboard shortcuts</h3>
        <ul>
          <li><span class="kbd">Cmd</span> or <span class="kbd">Ctrl</span> + <span class="kbd">D</span> - Duplicate selected</li>
          <li><span class="kbd">Shift</span> + <span class="kbd">Arrow</span> - Nudge 0.25 ft</li>
          <li><span class="kbd">Shift</span> + click - Multi select toggle</li>
          <li><span class="kbd">Cmd</span> or <span class="kbd">Ctrl</span> + click - Multi select toggle</li>
        </ul>

        <h3 id="tips">Pro tips</h3>
        <ul>
          <li>Color code by role: vocals, instruments, power, wedges, IEMs.</li>
          <li>Use the Mix field consistently (M1, M2, M3) for quick reading.</li>
          <li>Use Show notes for the stuff that prevents ten questions at load in.</li>
          <li>Export the project before a big edit spree (email it to yourself as a backup).</li>
          <li>Do tight placement with View Zoom, then Reset View to 100% before printing.</li>
          <li>If you are working with international venues, switch units to meters early so your stage size is correct from the start.</li>
        </ul>

        <h3 id="trouble">Troubleshooting</h3>

        <div class="callout danger">
          <strong>Print preview is blank</strong>
          <ul>
            <li>Click the app Print button again (it forces a print-safe rerender).</li>
            <li>Wait a second. Some browsers lag before painting.</li>
            <li>Try a different browser (Chrome, Edge, Safari).</li>
            <li>If you installed the PWA, try printing from a normal browser tab once.</li>
          </ul>
        </div>

        <div class="callout warn">
          <strong>Stage looks cut off or “cropped” while editing</strong>
          <ul>
            <li>Hit <strong>Reset View</strong> to return View Zoom to 100%.</li>
            <li>If you’re zoomed in (View Zoom &gt; 100%), some edges may be off-screen by design.</li>
            <li>On smaller screens, the app switches layouts and the stage square can change size. That is normal.</li>
          </ul>
        </div>

        <div class="callout">
          <strong>My stuff disappeared</strong>
          <ul>
            <li>StagePlot saves in localStorage. If you cleared browser site data, it resets.</li>
            <li>Use Export project as your backup habit.</li>
            <li>Each browser/device has its own local save.</li>
          </ul>
        </div>

        <div class="footer">
          Built for speed and sanity. If something feels annoying, that is a bug with a personality and we can fix it.
        </div>
      </div>
    </section>
  </main>

  <script>
    // Smooth anchor scrolling
    document.querySelectorAll('a[href^="#"]').forEach(a => {
      a.addEventListener("click", (e) => {
        const id = a.getAttribute("href");
        const el = document.querySelector(id);
        if(!el) return;
        e.preventDefault();
        el.scrollIntoView({ behavior: "smooth", block: "start" });
        history.replaceState(null, "", id);
      });
    });

    const APP_LINK = "https://petesimple.github.io/stageplot/";

    function toggleQR(){
      const el = document.getElementById("qrWrap");
      const show = (el.style.display === "none" || !el.style.display);
      el.style.display = show ? "block" : "none";
      if(show){
        document.getElementById("appLinkText").textContent = APP_LINK;
        const q = document.getElementById("qrImg");
        const enc = encodeURIComponent(APP_LINK);
        q.src = `https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${enc}`;
      }
    }

    async function copyAppLink(){
      try{
        await navigator.clipboard.writeText(APP_LINK);
        alert("Copied StagePlot link to clipboard.");
      }catch(e){
        const t = document.getElementById("appLinkText");
        if(t){
          const r = document.createRange();
          r.selectNodeContents(t);
          const sel = window.getSelection();
          sel.removeAllRanges();
          sel.addRange(r);
        }
        alert("Could not auto-copy on this browser. The link is highlighted. Copy it.");
      }
    }
  </script>
</body>
</html>